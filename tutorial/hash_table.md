# Хеш таблицы

![Хеш таблицы](../img/hash_map.jpg)

Хеш таблица - структура данных, которая использует хеш функцию для определения порядка хранения элементов. Различают два
вида хеш таблиц:

1. Множества - неупорядоченная, изменяемая последовательность уникальных элементов.
2. Словари - изменяемая последовательность элементов, содержащих в себе ключ и сами данные.

Основные преимущества хеш таблиц - это быстрая вставка и поиск элементов, временная сложность этих операций
составляет **O(1)**.

Ключевой идеей в реализации хеш таблиц является хеш функция, которая определяет индекс хранения элемента. При вставке
элемента хеш функция вычисляет индекс ячейки, куда будет вставлен новый элемент. При поиске элемента та же самая функция
вычисляет его расположение.

## Хеш функция

Если говорить простым языком, хеш-таблица – это массив, индекс которого вычисляется на основе хеш-функции по ключу. Если
для разных ключей хеш-функция возвращает одинаковый результат своего выполнения, то говорят о том, что произошла
коллизия, поэтому основная задача хеш-функции избегать коллизий и компактно «укладывать» объекты в таблицу.

Основной массив хранит набор так называемых корзин или сегментов. Каждый сегмент также можно представить в виде массива
элементов, хеш функция для которых возвращает одинаковое значение. На рисунке выше схематически представлено устройство
хеш-таблицы. Так для ключа ``0``, хеш функция ``key % 5`` вернула нулевой индекс, а для ключей ``1987`` и ``2`` индекс
совпал. В таком случае в связанную с индексом ``2`` корзину добавятся 2 элемента. Из этого следует вывод, что

```
Хеш-функция будет зависеть от диапазона значений ключа и общего количества сегментов. 
```

Основная задача хеш функции - равномерно заполнять основной массив и делать размер корзин как можно меньше. Идеальная
хеш функция та, при которой ячейка основного массива однозначно соотносится с элементом. Однако в большинстве случаев
хеш-функция не идеальна и всегда приходится искать компромисс между количеством сегментов и их емкостью.

Обратите внимание, что хеш-функция возвращает одно и то же значение только для неизменяемых объектов. Если в список было
добавлено новое значение, функция вернет новый результат. Именно поэтому в хеш таблице хранить изменяемые типы данных
запрещено. Иначе при изменении значения, должен измениться его индекс, а это недопустимо.

## Разрешение коллизий

Идеальная кеш функция не подвержена коллизиям - ячейка основного массива однозначно соотносится с элементом.

Алгоритм разрешения коллизий должен решать следующие вопросы:

1. Как реализовать хранение значений в одной корзине?
2. Что делать, если одной корзине назначено слишком много значений?
3. Как производить поиск элемента в корзине?

Все эти вопросы связаны с текущей длиной и общей вместимостью корзины. Если количество ключей корзины небольшое можно
использовать простой массив. Если количество большое - сбалансированное по высоте бинарное дерево.
